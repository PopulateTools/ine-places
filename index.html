<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ine-places by PopulateTools</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Ine-places</h1>
        <p>An easy way to work with Spanish regions in Ruby</p>

        <p class="view"><a href="https://github.com/PopulateTools/ine-places">View the Project on GitHub <small>PopulateTools/ine-places</small></a></p>


        <ul>
          <li><a href="https://github.com/PopulateTools/ine-places/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/PopulateTools/ine-places/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/PopulateTools/ine-places">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="ine-places-gem" class="anchor" href="#ine-places-gem" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>INE Places gem</h1>

<p>INE Places gem aims to help you to deal with Autonomous Regions, Provinces and Municipalities from
Spain. This data is provided by the INE (Instituto Nacional Estadística) in these URLs (see the <a href="https://github.com/PopulateTools/ine-places/#data_license">Data License</a> section for details about reuse rights):</p>

<ul>
<li><a href="http://www.ine.es/daco/daco42/codmun/codmun11/11codmunmapa.htm">http://www.ine.es/daco/daco42/codmun/codmun11/11codmunmapa.htm</a></li>
<li><a href="http://www.ine.es/jaxi/menu.do?type=pcaxis&amp;path=/t20/e245/codmun&amp;file=inebase&amp;L=0">http://www.ine.es/jaxi/menu.do?type=pcaxis&amp;path=/t20/e245/codmun&amp;file=inebase&amp;L=0</a></li>
</ul>

<p>According to that webpage the data <strong>was updated the 3rd of February, 2015</strong>. As you might know municipalities
data changes along the years: sometimes two municipalities are merged in a single one <a href="http://www.ine.es/daco/daco42/codmun/codmunmod.htm">more
information in Spanish</a>. For this
reason it's important to know the date of the data. The data included in this gem has been processed
based on the data published on the INE (so, it was processed after the 3rd of Feb, 2015).</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">gem</span> <span class="pl-s"><span class="pl-pds">'</span>ine-places<span class="pl-pds">'</span></span></pre></div>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install ine-places
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<p>This gem provides three Ruby classes:</p>

<ul>
<li><p><code>INE::Places::AutonomousRegion</code></p></li>
<li><p><code>INE::Places::Province</code></p></li>
<li><p><code>INE::Places::Place</code></p></li>
</ul>

<p>The data of these models is loaded from three CSV files included as part of the gem. Because the
size of the data is quite small, this gem will load all the data in memory.</p>

<h3>
<a id="ineplacesautonomousregion" class="anchor" href="#ineplacesautonomousregion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>INE::Places::AutonomousRegion</h3>

<p>This model represents the <a href="https://en.wikipedia.org/wiki/Autonomous_communities_of_Spain">autonomous regions in Spain</a>.</p>

<p>The attributes of this model are:</p>

<ul>
<li>id: INE code</li>
<li>name: the official name in the INE</li>
<li>slug: a sanitized unique name, valid for URLs</li>
<li>lon: longitude of the central point</li>
<li>lat: latitude of the central point</li>
</ul>

<p>To obtain all the autonomous regions:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">AutonomousRegion</span>.all</pre></div>

<p>To obtain a single one based on the INE code:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">AutonomousRegion</span>.find(<span class="pl-s"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::AutonomousRegion id="1", name="Andalucía", slug="andalucia", lon="-4.7277528", lat="37.5442706"&gt;</span></pre></div>

<p>To obtain a single one based on the name:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">AutonomousRegion</span>.find_by_name(<span class="pl-s"><span class="pl-pds">'</span>Andalucía<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::AutonomousRegion id="1", name="Andalucía", slug="andalucia", lon="-4.7277528", lat="37.5442706"&gt;</span></pre></div>

<p>To obtain a single one based on the slug:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">AutonomousRegion</span>.find_by_slug(<span class="pl-s"><span class="pl-pds">'</span>andalucia<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::AutonomousRegion id="1", name="Andalucía", slug="andalucia", lon="-4.7277528", lat="37.5442706"&gt;</span></pre></div>

<h3>
<a id="ineplacesprovince" class="anchor" href="#ineplacesprovince" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>INE::Places::Province</h3>

<p>This model represents the <a href="https://en.wikipedia.org/wiki/Provinces_of_Spain">provinces in Spain</a></p>

<p>The attributes of this model are:</p>

<ul>
<li>id: INE code</li>
<li>name: the official name in the INE</li>
<li>slug: a sanitized unique name, valid for URLs</li>
<li>autonomous_region_id: the INE code of the autonomous region</li>
<li>autonomous_region: the AutonomousRegion object</li>
<li>lon: longitude of the central point</li>
<li>lat: latitude of the central point</li>
</ul>

<p>To obtain all the provinces:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Province</span>.all</pre></div>

<p>To obtain a single one based on the INE code:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Province</span>.find(<span class="pl-s"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Province id="1", name="Araba/Álava", slug="alava", autonomous_region_id="16", lon="-2.6983868", lat="42.9099989", autonomous_region=#&lt;INE::Places::AutonomousRegion id="16", name="País Vasco", slug="pais-vasco", lon="-2.6189273", lat="42.9896248"&gt;&gt;</span></pre></div>

<p>To obtain a single one based on the name:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Province</span>.find_by_name(<span class="pl-s"><span class="pl-pds">'</span>Araba/Álava<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Province id="1", name="Araba/Álava", slug="alava", autonomous_region_id="16", lon="-2.6983868", lat="42.9099989", autonomous_region=#&lt;INE::Places::AutonomousRegion id="16", name="País Vasco", slug="pais-vasco", lon="-2.6189273", lat="42.9896248"&gt;&gt;</span></pre></div>

<p>To obtain a single one based on the slug:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Province</span>.find_by_slug(<span class="pl-s"><span class="pl-pds">'</span>alava<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Province id="1", name="Araba/Álava", slug="alava", autonomous_region_id="16", lon="-2.6983868", lat="42.9099989", autonomous_region=#&lt;INE::Places::AutonomousRegion id="16", name="País Vasco", slug="pais-vasco", lon="-2.6189273", lat="42.9896248"&gt;&gt;</span></pre></div>

<h3>
<a id="ineplacesplace" class="anchor" href="#ineplacesplace" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>INE::Places::Place</h3>

<p>This model represents the <a href="https://en.wikipedia.org/wiki/List_of_municipalities_of_Spain">municipalities in Spain</a></p>

<p>The attributes of this model are:</p>

<ul>
<li>id: INE code</li>
<li>name: the official name in the INE</li>
<li>slug: a sanitized unique name, valid for URLs</li>
<li>province_id: the INE code of the province</li>
<li>province: the Province object</li>
<li>lon: longitude of the central point</li>
<li>lat: latitude of the central point</li>
</ul>

<p>To obtain all the places:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Place</span>.all</pre></div>

<p>To obtain a single one based on the INE code:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Place</span>.find(<span class="pl-s"><span class="pl-pds">'</span>46078<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Place id="46078", name="Burjassot", slug="burjassot", province_id="46", lon="-0.4135963", lat="39.5096699", province=#&lt;INE::Places::Province id="46", name="Valencia/València", slug="valencia", autonomous_region_id="10", lon="-0.3762881", lat="39.4699075", autonomous_region=#&lt;INE::Places::AutonomousRegion id="10", name="Comunidad Valenciana", slug="comunidad-valenciana", lon="-0.7532808999999999", lat="39.4840108"&gt;&gt;&gt;</span></pre></div>

<p>To obtain a single one based on the name:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Place</span>.find_by_name(<span class="pl-s"><span class="pl-pds">'</span>Burjassot<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Place id="46078", name="Burjassot", slug="burjassot", province_id="46", lon="-0.4135963", lat="39.5096699", province=#&lt;INE::Places::Province id="46", name="Valencia/València", slug="valencia", autonomous_region_id="10", lon="-0.3762881", lat="39.4699075", autonomous_region=#&lt;INE::Places::AutonomousRegion id="10", name="Comunidad Valenciana", slug="comunidad-valenciana", lon="-0.7532808999999999", lat="39.4840108"&gt;&gt;&gt;</span></pre></div>

<p>To obtain a single one based on the slug:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Place</span>.find_by_slug(<span class="pl-s"><span class="pl-pds">'</span>burjassot<span class="pl-pds">'</span></span>)
=&gt; <span class="pl-c">#&lt;INE::Places::Place id="46078", name="Burjassot", slug="burjassot", province_id="46", lon="-0.4135963", lat="39.5096699", province=#&lt;INE::Places::Province id="46", name="Valencia/València", slug="valencia", autonomous_region_id="10", lon="-0.3762881", lat="39.4699075", autonomous_region=#&lt;INE::Places::AutonomousRegion id="10", name="Comunidad Valenciana", slug="comunidad-valenciana", lon="-0.7532808999999999", lat="39.4840108"&gt;&gt;&gt;</span></pre></div>

<h2>
<a id="hydratating-models-with-data-experimental-feature" class="anchor" href="#hydratating-models-with-data-experimental-feature" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hydratating models with data (experimental feature)</h2>

<p>It's quite common to work with data related with the entities provided by this gem. For example, to know the debt of a place, the amount of schools, the number of inhabitants, and so on. This data lives in external sources, such a CSV or a JSON file, or an API endpoint but can be co-related with the entities using an ID column.</p>

<p>Hydratation feature helps you with this issue. For the moment it's very experimental but allows you to add basics sets of data from a local CSV file.</p>

<p>For example, given a CSV file with a single row:</p>

<pre lang="csv"><code>municipio,value
28079,33
</code></pre>

<p>You could hydratate the model <code>INE::Places::Place</code> using the <code>.hydrate</code> function:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>.hydratate <span class="pl-c1">INE</span>::<span class="pl-c1">Places</span>::<span class="pl-c1">Place</span>, <span class="pl-s"><span class="pl-pds">'</span>spec/fixtures/happiness.csv<span class="pl-pds">'</span></span>, <span class="pl-c1">id_column:</span> <span class="pl-s"><span class="pl-pds">'</span>municipio<span class="pl-pds">'</span></span>,
                                                                         <span class="pl-c1">as:</span> <span class="pl-c1">:happiness</span>,
                                                                         <span class="pl-c1">value_column:</span> <span class="pl-s"><span class="pl-pds">'</span>value<span class="pl-pds">'</span></span></pre></div>

<p>You just need to provide:</p>

<ul>
<li>id column, to match the IDs</li>
<li>the <code>as</code> column, with the name of the new method</li>
<li>the value column, to know exactly where the value is</li>
</ul>

<p>After hydratating a class, every object of the class has the new method in the <code>.data</code> property:</p>

<div class="highlight highlight-source-ruby"><pre>place.data.happiness
<span class="pl-c">#&gt; 100</span></pre></div>

<h2>
<a id="development" class="anchor" href="#development" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Development</h2>

<p>After checking out the repository, run <code>bin/setup</code> to install dependencies. Then, run <code>rake spec</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt that will allow you to experiment.</p>

<p>To install this gem onto your local machine, run <code>bundle exec rake install</code>. To release a new version, update the version number in <code>version.rb</code>, and then run <code>bundle exec rake release</code>, which will create a git tag for the version, push git commits and tags, and push the <code>.gem</code> file to <a href="https://rubygems.org">rubygems.org</a>.</p>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/PopulateTools/ine-places">https://github.com/PopulateTools/ine-places</a>. This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="http://contributor-covenant.org">Contributor Covenant</a> <a href="CODE_OF_CONDUCT.md">code of conduct</a>.</p>

<h2>
<a id="data-license" class="anchor" href="#data-license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data License</h2>

<p>We have created the CSV files we use as source for the gem to make data availabale from data extracted from INE. In spanish and according to INE's own formula: </p>

<p><em>Elaboración propia con datos extraídos del sitio web del INE: <a href="http://www.ine.es">www.ine.es</a></em></p>

<p>Please read the conditions about reusing the data provided by this gem in INE's <a href="http://www.ine.es/ss/Satellite?L=0&amp;c=Page&amp;cid=1254735849170&amp;p=1254735849170&amp;pagename=Ayuda%2FINELayout#">Licensing page</a> (in spanish).</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>The gem is available as open source under the terms of the <a href="http://opensource.org/licenses/MIT">MIT License</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/PopulateTools">PopulateTools</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
